Please remove all automatic tests which specifically test that one layout model has correct array-shape for the matrices thirthyKeyMapping, thumb30KeyMapping, finger assignment, and key effort.
Instead, create a new "layout-models.test.ts" which checks the matrix shape generically for all layouts, similar to src/mapping/mappings.test.ts
Tests should not expect specific row lengths for each layout model (LM).
Just check that all the matrices in each LM have the same size.
Don't fix the layout models that are inconsistent. I will do it later myself.
For reporting the names of LMs in the test, use their .name property.
When names are repeated, add specific .name properties to the LMs which are lacking them.

---

In the MappingArea, add a checkbox (using components/CheckboxWithLabel.tsx) with label "show all mappings".
By default, this should be switched off, and the mapping list below should only show mappings with the localMaximum flag and Qwerty (standard).
When the flag is on, the list should look exactly as it does now.
But when it's off, don't show color backgrounds in the list, except for the currently selected mapping.

Started 21:34

"Keep the signal for this local to the MappingList." (I did that myself, as well as another fix.)

---

In the ErgoplankLayoutOptions, under "Ergoplank 60", add another checkbox labeled "ANSI angle", disabled by default.
Add a state "ep60ansiAngle: boolean" for this in the LayoutOptions object, with encoding in the URL as "ep60ansi".
Not that getPlankVariant() in layout-selection.ts already uses this.

---

In the AnsiLayoutOptions, replace the checkbox "use Apple form factor" with a set of three radio buttons:
 - IBM
 - Apple
 - HHKB
 - AHKB

Connect them to the value "ansiVariant" in the LayoutOptions object and in the URL handling, replace "ansiApple" with "ansiVariant".

In app-state.ts setLayout(), force 'ansiWide = true' when AHKB is selected.
Also disable the checkbox "use wide key mapping" (in the checked state) when AHKB is selected.

# follow-up

Instead of just checking the "wide" button for AHKB on the UI, it should be set to true in the global setLayout function.
Similarly, when HHKB is selected, set "ansiSplit = false" in setLayout() and disable the checkbox in the UI.
(Note that I changed some files, please read everything again.)

Finally, I did it myself again, because Codex created much more code than what was needed.

---

Have a look at ergoPlank60LayoutModel.ts and how the thumb30KeyMapping there differs from the thirtyKeyMapping.
You can also check some other layouts, in particular ansiLayoutModel.
Now, implement the thumb30KeyMapping for the ahkbLayoutModel, derived from its ahkb's thirtyKeyMapping.

---

Have a look at ErgoplankLayoutOptions.tsx and ergoPlank60LayoutModel.ts.
Your task is to implement a similar "angle mod" feature for the AHKB layout.
The checkbox should appear below the "AHKB" radio button if and only if the latter is selected.
(Implemented in AnsiLayoutOptions.tsx.)
The rotation of letters should be done in a similar way:
 - the second letter from lower row goes to first position of home row
 - five characters from the lower row move left by one step
 - (and this is different from the Ergoplank) the delete symbol ⌦ moves between \ and / on the lower row.
   (Note that / is represented by the '9' position of the logical keymap filled into the layout keymap.)

# follow-up

Merge the two 'angleMod' layout flags into one that is just called "angleMod" and applied for both layouts.

---

In LayoutArea.tsx change the TypeSpecificOptions component and its children, so that for any LayoutOptions,
only 'options' and 'setOption' (singular, taking a Partial<LayoutOptions> as in the Ergoplank case) are passed as parameters to the child components.
Other parameters like "mapping" should not be changed.

---

Have a look at all the constants in files in src/layouts which implement the RowBasedKeyboardLayout.
Compare the different ways in which the keyWidth function is implemented.
Suggest how the code could be shortened while still being readable and keeping implementation style similar.
Take into account where the getSymmetricOdd and -Even functions can be useful.

==> I read the advice and then decided for my own architecture instead.

---

Change the function 'rowStart' in RowBasedLayoutModel to be a constant array instead. All layout models should have an entry like 'rowStart: [0, 0, 0, 0, 0],' or 'rowStart: [0, 0, 0, 0, 0.5]' reflecting exactly the current behavior.
Change all the layout models and all usages of 'rowStart'. You do not need to add or leave code that still supports the old functional definition.

---

add the angleMod checkbox and layout variant for the eb65 low shift wide hands layout.

postscript: I should have told it to add an empty function for actually modifying the layout, that would have been faster and I fixed that function manually anyway.

---

The characters "⌫" and "⏎" are currently mapped inconsistenty in the layout models of the Ergoboard family (and only those, not Ergoplank or others). Can you change the keymap constants, such that:
 - when currently both "⌫" and "⏎" are mapped in the last column of number/upper/home row, then "⌫" should be mapped above "⏎".
 - when currently one of them is in the last column of said rows and the other is in the bottom row, then "⌫" should be in the last column above and "⏎" should be in the bottom row.

---

function getKeyPositions() in layout-functions.ts, many tests, and maybe other relevant places currently have a pattern to iterate over a keymap matrix and then use the row and col to get the key width from the keyWidths matrix.
When I am changing some layouts and hot-reloading, both matrices can be inconsistent, which leads to display errors.
Please change the code (also in tests) so that the keyWidths matrix is always the basis for iterations and the key maps are indexed by row and col, using a default value like "??" when the array access returns `undefined`.
(Handling of `null` should not be changed.)

while it's thinking: to get started, search for patterns like "fullMapping.forEach", "thirtyKeyMapping.map" and similar.

---

